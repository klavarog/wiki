Одна из самых популярных ОС, которую нужно поддерживать в плане разработки софта для клавиатур.

## Инструменты

* [[https://steve-key.ucoz.ru/load/klmlite/1-1-0-43|Keyboard Layout Manager]] — вносит изменения в ТЕКУЩУЮ раскладку на компьютере, причём, lite работает отлично без крека и регистрации.
* [[https://www.microsoft.com/en-us/download/details.aspx?id=22339|Microsoft Keyboard Layout Creator]] (MSKLC) - программа для создания раскладок.
* [[https://keyman.com/desktop/|Keyman Desktop 11.0]] — программа для переназначения клавиш.
* [[https://steve-key.ucoz.ru/news/poslednjaja_versija_keyman_4_28_freeware/2010-12-06-3|KeyMan]] — программа для переназначения клавиш, обладает большим списком возможностей, среди которых:
** Перехват нажатий клавиш на HID устройствах (USB клавиатуры, мыши, джойстики, пульты ДУ и даже UPS).
** Управление медиа проигрывателями: WinAmp 2.9x/5.x, BSplayer, Light Alloy, Windows Media Player 9.x/10.x, foobar2000 + автоопределение текущего проигрывателя.
** Использование любых клавиш, в том числе системных – Win+D, Alt+Tab, ect. (Исключением являются: Ctrl+Alt+Del и клавиша Tab без модификаторов).
** Использование кнопок мыши в горячих клавишах - Mouse LButton, Mouse RButton, Mouse MButton, Mouse XButton1, Mouse XButton2 (например: Ctrl+Alt+Mouse MButton).
** Запуск нескольких действий на одну клавишу.
** Запись и воспроизведение клавиатурных макросов.
** Изменение клавиатурных раскладок.
** Гибкая схема запуска действия, например: только если активно определенное окно или оно существует.
** Замена нажатой клавиши на другую клавишу, или кнопку мыши (например: F2 на Ctrl+V, и вы получаете содержимое буфера обмена).
** Замена кнопок мыши на другую кнопку мыши, или клавишу клавиатуры (например: Shift + Mouse Middle на Alt + DblClick).
** Назначение горячих клавиш с расширенными модификаторами (любая комбинация из четырех модификаторов Ctrl+ Alt+ Shift+ Win+ ).
** Индикация текущей языковой раскладки - звуком при нажатии клавиш и/или иконкой в системном трее.
** Отправление окну сообщения при нажатии клавиши.
** Программа поддерживает модули расширений (PlugIns). Стандарт модулей предельно прост и используя исходный код готового модуля, вы можете сами написать нужное вам действие (в дистрибутиве программы есть исходный код PlugIn'а написанного на Borland Delphi7, содержащий все необходимые комментарии).
** Многоязычный интерфейс.
** Хотя программа и "заброшена" автором, но перед этим она была доведена "до ума", а позже - выпущена представленная здесь бесплатная фряшная версия, по моей просьбе автор разрешил использовать её всем желающим.
* [[https://github.com/klavarog/enhanced-keyboard|Enhanced Keyboard]] — программа для переназначения клавиш. Главным отличием данной программы от других является явная возможность создания слоя.
* [[https://code.google.com/archive/p/keyla/wikis/ru_Main.wiki|keyla]] — программа для назначения клавиш переключения раскладок под Windows. Назначает любые клавиши и их сочетания для циклического или «жёсткого» переключения.
* [[https://github.com/samhocevar/wincompose|WinCompose]] — позволяет легко писать специальные символы такие как é ž à ō û ø и так далее.

## Методы WinAPI для работы с клавиатурами
Хуки позволяют прослушивать все нажатия клавиатуры, и, если нужно, отменять некоторые из них, чтобы нажать другие. Хуки выставляются функцией [[https://docs.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-setwindowshookexa|SetWindowsHookExA]].

Функция [[https://docs.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-sendinput|SendInput]] позволяет отправлять нажатие клавиатуры.

=> https://github.com/optozorax/moonlander/tree/master/modbind | Посмотреть использование этих функций можно в старых программах optozorax'а